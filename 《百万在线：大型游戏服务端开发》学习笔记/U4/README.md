第四章：Skynet 进阶技法

-------------------------------------------

# 4.1 用"长度信息" 解TCP包

这个没啥好说的...

-------------------------------------------

# 4.2 用 json 序列化协议

这个也没啥好说的...需要注意的就是 对协议这东西的理解...

json 是一种数据格式，且可以对数据进行序列化和反序列化；

协议（客户端-服务器）  <->  json（中间层）  <->  lua表（服务器-服务器）

上面是消息在不同阶段的传输形式。

-------------------------------------------

# 4.3 用 Protobuf 高效传输

巧了吗这不是，公司用的也是 protobuf + lua

（其实我是看了目录刚好有 lua + protobuf 才决定买这书的hhh）

protobuf 也是一种协议格式（或者说是数据格式，PB结构）

.proto 文件被称作描述文件，用于描述数据格式；

通过 protoc 工具可以转换成 .pb 格式的文件（二进制）

然后再传输的时候就用二进制协议传输；

消息格式：二进制 <-> PB结构 <-> lua表

在安装 Protobuf 和 pbc 工具的时候需要注意：

关于安装 Protobuf ：在 Ubuntu 下用 sudo apt-get install ... 就行

关于安装 pbc：
    
    git clone 下来之后，不能直接进入 lua53 make，会报错...
    
    得先在主目录(pbc/) make 一下，生成 libpbc.a 静态库，再去 lua53 里面make才不会报错

-------------------------------------------

# 4.4 如何设计游戏数据库

这个也没啥好讲的...

4.4.3 这个 kv 式表结构挺不错，学到了

直接存PB序列化后的值就行

4.4.8 拆分数据表 也挺有启发的

-------------------------------------------

# 4.5 如何关闭服务器

个人感觉这个挺有意思的

-------------------------------------------

# 4.6 怎样做定时系统

-------------------------------------------

# 4.7 断线重连

这个也挺有意思的

-------------------------------------------

终于把第四章看完了！
